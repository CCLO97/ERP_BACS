{% extends "base.html" %}

{% block title %}Nuevo Sistema - ERP BACS{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Nuevo Sistema</h1>
    <p class="page-subtitle">Crear un nuevo sistema para categorizar incidencias</p>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">Información del Sistema</h2>
    </div>
    
    <form method="POST">
        <div class="form-group">
            <label class="form-label">Nombre del Sistema *</label>
            <input type="text" name="nombre" class="form-control" required 
                   placeholder="Ej: CCTV, Control de Acceso, Alarmas...">
            <small style="color: #666;">Nombre único que identifica el sistema</small>
        </div>
        
        <div class="form-group">
            <label class="form-label">Descripción</label>
            <textarea name="descripcion" class="form-control" rows="4" 
                      placeholder="Descripción detallada del sistema y sus características..."></textarea>
            <small style="color: #666;">Descripción opcional del sistema (máximo 500 caracteres)</small>
        </div>
        
        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i> Crear Sistema
            </button>
            <a href="{{ url_for('sistemas') }}" class="btn btn-secondary">
                <i class="fas fa-times"></i> Cancelar
            </a>
        </div>
    </form>
</div>

<!-- Ejemplos de sistemas -->
<div class="card mt-3">
    <div class="card-header">
        <h2 class="card-title">Ejemplos de Sistemas</h2>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <h4>Sistemas de Seguridad</h4>
                <ul>
                    <li><strong>CCTV:</strong> Videovigilancia y cámaras de seguridad</li>
                    <li><strong>Control de Acceso:</strong> Sistemas de acceso y tarjetas</li>
                    <li><strong>Alarmas:</strong> Sistemas de detección de intrusos</li>
                    <li><strong>Seguridad Perimetral:</strong> Cercas eléctricas y sensores</li>
                </ul>
            </div>
            <div class="col-md-6">
                <h4>Sistemas de Infraestructura</h4>
                <ul>
                    <li><strong>Redes:</strong> Infraestructura de red y comunicaciones</li>
                    <li><strong>Automatización:</strong> Sistemas de control automatizado</li>
                    <li><strong>Iluminación:</strong> Sistemas de iluminación inteligente</li>
                    <li><strong>Climatización:</strong> Sistemas HVAC y climatización</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
// Validación del formulario
document.querySelector('form').addEventListener('submit', function(e) {
    const nombre = document.querySelector('input[name="nombre"]').value.trim();
    const descripcion = document.querySelector('textarea[name="descripcion"]').value.trim();
    
    if (!nombre) {
        e.preventDefault();
        alert('El nombre del sistema es obligatorio');
        return;
    }
    
    if (descripcion.length > 500) {
        e.preventDefault();
        alert('La descripción no puede exceder los 500 caracteres');
        return;
    }
});

// Contador de caracteres para la descripción
document.querySelector('textarea[name="descripcion"]').addEventListener('input', function() {
    const maxLength = 500;
    const currentLength = this.value.length;
    const remaining = maxLength - currentLength;
    
    // Crear o actualizar contador
    let counter = document.getElementById('char-counter');
    if (!counter) {
        counter = document.createElement('small');
        counter.id = 'char-counter';
        counter.style.color = '#666';
        this.parentNode.appendChild(counter);
    }
    
    counter.textContent = `${currentLength}/${maxLength} caracteres`;
    
    if (remaining < 0) {
        counter.style.color = 'red';
    } else if (remaining < 50) {
        counter.style.color = 'orange';
    } else {
        counter.style.color = '#666';
    }
});
</script>
{% endblock %}
